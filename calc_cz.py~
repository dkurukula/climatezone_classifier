import pandas as pd
import numpy as np
from pathlib import Path
p = Path.cwd()
PATH_TO_WEATHER = p.joinpath('weather_data')

fl =list(PATH_TO_WEATHER.glob('*.ft'))

def get_cz(HDD):
    '''takes HDD and return cz from 4-8
       based on ASHRAE 90.1-2010 Table B-4 International Climate Zone Definitions'''
    if (HDD>3600) & (HDD<=5400):
        cz = 4
    elif (HDD>5400) & (HDD<=7200):
        cz = 5
    elif (HDD>7200) & (HDD<=9000):
        cz = 6
    elif (HDD>9000) & (HDD<=12600):
        cz = 7
    elif (HDD>12600):
        cz = 8
    else:
        print('HDD outside expected range')
        cz = 0
    return cz

l = []
for sf in fl:
    d = {}
    df = pd.read_fwf(sf, skiprows = 3, header = None)
    HDD = int(round((65-df[2]).sum()/24))
    #cz = get_cz(HDD)
    d['City'] = sf.stem
    d['HDD'] = HDD
    d['Climate Zone'] = cz
    l.append(d)

df = pd.DataFrame(l)
print(df)
